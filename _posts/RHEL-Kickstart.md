---
title: "Getting started with RHEL Kickstart files"
tags:
  - RHEL
last_modified_at: '2022-05-03'
---
# RHEL-Kickstart
RedHat and its derivatives can utilize special configuration files called "Kickstart files" to make installation automated and repeatable. I wanted to explore this for my [RHEL Migration]() project where I am moving from CentOS 7 to RHEL 8.

## Obtaining a basic configuration
The simplest way to get a basic Kickstart file is to install your distro like you normally would then copy the `anaconda-ks.cfg` file that is generated by the installer (called Anaconda) and left in `/root` on your new system. This file contains the parameters that you chose during your graphical setup process. It holds all settings including:

* Package selection
* Keyboard layout and language selection
* Network configurations
  * Hostname
  * Static/DHCP settings
* Disk layouts
* Timezone
* Root password and optional user configurations
* Password policies

## Using your Kickstart file for an unattended install

## Changes you can make to the Kickstart file
### Package management
In the `%packages` block you will see any packages you have already chosen to install. For me this is "@^minimal-environment". In this case "@^" marks a meta-group of packages. 

You can add more packages below `%packages` header as well as remove packages from the selection. I do not like Firewalld but this is added in the "@^minimal-environment" meta-package. To remove a package use a `-`. My entire package selection is as follows:

```shell
%packages
@^minimal-environment
# realm packages
realmd
sssd
oddjob
oddjob-mkhomedir
adcli
samba-common-tools
# other packages
vim
iptables-services
cockpit
# exlcude
-firewalld
%end
```

> ğŸ“You can read more about package selection [in the official docs](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/installation_guide/sect-kickstart-syntax#sect-kickstart-packages)

### Network configuration
Network configurations can be simple. I would specify each NIC with its own line and the hostname on its own as well. You can do various actions such as disabling v6, setting nameservers, etc.

#### DHCP
```
network  --bootproto=dhcp --device=eth0 --noipv6 --activate
```

#### Static
```
network --bootproto=static --ip=10.0.2.15 --netmask=255.255.255.0 --gateway=10.0.2.254 --nameserver=10.0.2.1,10.0.2.2 --noipv6 --activate
```

> ğŸ“You can read more about network configurations [in the official docs](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/installation_guide/sect-kickstart-syntax#sect-kickstart-commands)

### Register with RedHat automatically
Setting up your subscription (necessary to pull updates from the RH repos) is done via a "post install script" and it placed in a `%post%` block. Your username and password are required, they are saved in plain text in this file.

```shell
%post --log=/root/ks-post.log
subscription-manager register --username=<username> --password=<password> --auto-attach
%end
```

> ğŸ“ You can read more about how to use post install scripts [here](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/installation_guide/sect-kickstart-syntax#sect-kickstart-postinstall) and more on the subscription manager [here](https://access.redhat.com/solutions/748313)
